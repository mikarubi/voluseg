---
title: Pipeline Parameters
sidebar_position: 8
---

## Parameters dictionary
To run the Voluseg pipeline, you need to set up the parameters. The parameters are stored in a dictionary and can be modified to fit your specific needs. The parameters are used to control the behavior of the pipeline, such as the type of detrending, registration quality, cell diameter, and resolution.

---

### Input/Output Paths

#### `input_dirs` (List[DirectoryPath], required)

List of input directories containing the raw imaging data. Each must be a valid directory path.

#### `dir_output` (str, required)

Path to the directory where output files will be saved.

#### `dir_transform` (DirectoryPath, default=`""`)

Directory containing precomputed transform files. If not provided, registration will compute new ones.

---

### Preprocessing Options

#### `detrending` (`standard` | `robust` | `none`, default=`standard`)

Type of detrending applied to the timeseries data:
- `standard`: Standard z-score detrending
- `robust`: Robust detrending using median/MAD
- `none`: No detrending

#### `registration` (`high` | `medium` | `low` | `none` | `transform`, default=`medium`)

Quality or mode of registration:
- `high`: High-accuracy (slowest)
- `medium`: Balanced setting
- `low`: Fast but less accurate
- `none`: No registration
- `transform`: Use precomputed transforms from `dir_transform`

#### `opts_ants` (dict, default=`{}`)

Custom arguments passed to the ANTs registration backend.

---

### Cell Segmentation

#### `diam_cell` (float > 0, default=`6.0`)

Estimated cell diameter in microns.

#### `dim_order` (`xyz` | `xzy` | `yxz` | `yzx` | `zxy` | `zyx`, default=`zyx`)

Ordering of dimensions in input volume arrays.

#### `nwb_output` (bool, default=`False`)

Whether to output results in NWB format.

---

### Spatial Settings

#### `ds` (int > 0, default=`2`)

Spatial downsampling factor in the XY plane.

#### `planes_pad` (int ≥ 0, default=`0`)

Number of planes to pad on either side in Z for registration robustness.

---

### Performance Settings

#### `parallel_extra` (bool, default=`True`)

Enable extra parallel processing steps (e.g., cleaning). Requires more memory.

#### `save_volume` (bool, default=`False`)

Whether to save intermediate registered volumes.

---

### Timepoint and Masking

#### `type_timepoints` (`dff` | `periodic` | `custom`, default=`dff`)

Type of timepoint selection for segmentation:
- `dff`: Use ΔF/F signals
- `periodic`: Use uniformly spaced timepoints
- `custom`: Use manually specified timepoints

#### `timepoints` (int ≥ 0 or list of int, default=`1000`)

Timepoints used for segmentation. Can be a number (`dff`/`periodic`) or a list (`custom`).

#### `type_mask` (`mean` | `geomean` | `max`, default=`geomean`)

Aggregation method for generating the volume mask:
- `mean`: Mean across timepoints
- `geomean`: Geometric mean
- `max`: Maximum intensity

---

### Signal Filtering

#### `f_hipass` (float ≥ 0, default=`0`)

High-pass filter cutoff frequency for timeseries data in Hz.

#### `f_volume` (float > 0, default=`2.0`)

Imaging frame rate (volume rate) in Hz.

---

### Block Configuration

#### `n_cells_block` (int > 0, default=`316`)

Expected number of cells per spatial block.

#### `n_colors` (int > 0, default=`1`)

Number of imaging channels (colors). Use `2` for two-color experiments.

---

### Voxel Resolution

#### `res_x`, `res_y` (float > 0, default=`0.40625`)

Spatial resolution in X and Y (in microns).

#### `res_z` (float > 0, default=`5.0`)

Spatial resolution in Z (in microns).

---

### Timing Parameters

#### `t_baseline` (int > 0, default=`300`)

Time in seconds used to calculate baseline fluorescence.

#### `t_section` (float > 0, default=`0.01`)

Exposure time for a single slice in seconds.

---

### Masking Threshold

#### `thr_mask` (float ≥ 0, default=`0.5`)

Threshold for volume masking. Use:
- `0 < thr ≤ 1` for probability-based masking
- `thr > 1` for intensity-based masking

---

### Overwrite Behavior

#### `overwrite` (bool, default=`False`)

If `True`, overwrite existing output files in `dir_output`.

---
