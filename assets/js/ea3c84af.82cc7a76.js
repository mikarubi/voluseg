"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4266],{1268:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>r,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>u});var t=a(4848),o=a(8453);const l={title:"Running from Container",sidebar_position:3},i=void 0,s={id:"getting_started/running_container",title:"Running from Container",description:"You can easily run the Voluseg pipeline using a container. This is useful if you want to run the pipeline without having to install all the dependencies on your local machine.",source:"@site/docs/getting_started/running_container.mdx",sourceDirName:"getting_started",slug:"/getting_started/running_container",permalink:"/voluseg/docs/getting_started/running_container",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Running from Container",sidebar_position:3},sidebar:"docsSidebar",previous:{title:"Running Voluseg Pipeline",permalink:"/voluseg/docs/getting_started/running"},next:{title:"Running on AWS Batch",permalink:"/voluseg/docs/getting_started/iac_aws_batch"}},r={},u=[{value:"Using Docker",id:"using-docker",level:2},{value:"Example: reading from a remote NWB file",id:"example-reading-from-a-remote-nwb-file",level:3},{value:"For developers",id:"for-developers",level:3},{value:"Using Apptainer",id:"using-apptainer",level:2}];function d(e){const n={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"You can easily run the Voluseg pipeline using a container. This is useful if you want to run the pipeline without having to install all the dependencies on your local machine."}),"\n",(0,t.jsx)(n.h2,{id:"using-docker",children:"Using Docker"}),"\n",(0,t.jsx)(n.p,{children:"Pull the image from GHCR:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker pull ghcr.io/mikarubi/voluseg/voluseg:latest\n"})}),"\n",(0,t.jsx)(n.p,{children:"Run with access to your local data and pass user-defined parameters values:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run \\\n-v $(pwd)/local_data:/voluseg/data \\\n-v $(pwd)/output:/voluseg/output \\\nvoluseg \\\npython3 /voluseg/app/app.py \\\n--registration high \\\n--diam-cell 5.0\n"})}),"\n",(0,t.jsx)(n.p,{children:"To get a list of all available parameters, run:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run voluseg python3 /voluseg/app/app.py --help\n"})}),"\n",(0,t.jsx)(n.h3,{id:"example-reading-from-a-remote-nwb-file",children:"Example: reading from a remote NWB file"}),"\n",(0,t.jsxs)(n.p,{children:["Voluseg can read from remote NWB files stored in S3 buckets. To do this, you should pass the URL of the NWB file to the ",(0,t.jsx)(n.code,{children:"--dir-input"})," parameter:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'docker run \\\n-v $(pwd)/output_stream:/voluseg/output  \\\nvoluseg \\\npython3 /voluseg/app/app.py \\\n--registration high \\\n--diam-cell 5.0 \\\n--dir-input "https://dandiarchive.s3.amazonaws.com/blobs/057/ecb/057ecbef-e732-4e94-8d99-40ebb74d346e"\n'})}),"\n",(0,t.jsx)(n.h3,{id:"for-developers",children:"For developers"}),"\n",(0,t.jsx)(n.p,{children:"From the repository root, you can build the image locally and run it with hot reload for the voluseg package (useful for development)."}),"\n",(0,t.jsx)(n.p,{children:"Build the image locally:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"DOCKER_BUILDKIT=1 docker build -t voluseg .\n"})}),"\n",(0,t.jsx)(n.p,{children:"Run with local data volume mount, default parameters values and hot reload for the voluseg package:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run \\\n-v $(pwd)/local_data:/voluseg/data \\\n-v $(pwd)/output:/voluseg/output \\\n-v $(pwd)/voluseg:/voluseg/voluseg \\\n-v $(pwd)/app:/voluseg/app \\\nvoluseg\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-apptainer",children:"Using Apptainer"}),"\n",(0,t.jsx)(n.p,{children:"Pull the image from GHCR and convert it to an Apptainer image:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"apptainer pull docker://ghcr.io/mikarubi/voluseg/voluseg:latest\n"})}),"\n",(0,t.jsx)(n.p,{children:"Run with access to your local data and pass user-defined parameters values:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"apptainer exec \\\n--bind $(pwd)/local_data:/voluseg/data \\\n--bind $(pwd)/output:/voluseg/output  \\\nvoluseg_latest.sif \\\npython3 /voluseg/app/app.py \\\n--registration high \\\n--diam-cell 5.0 \\\n--no-parallel-volume \\\n--no-parallel-clean \\\n2>&1 | tee log_file.log\n"})})]})}function c(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>s});var t=a(6540);const o={},l=t.createContext(o);function i(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);